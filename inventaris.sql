CREATE DATABASE PENJUALAN_PBD_0070

USE PENJUALAN_PBD_0070

CREATE TABLE BARANG(
KODE_BARANG CHAR (5) PRIMARY KEY NOT NULL,
NAMA_BARANG VARCHAR(50) NOT NULL,
HARGA_SATUAN NUMERIC(18,0),
STOK INT
)

CREATE TABLE PELANGGAN(
KD_PELANGGAN CHAR (5) NOT NULL PRIMARY KEY,
NAMA_PELANGGAN VARCHAR(100) DEFAULT 'USER',
ALAMAT VARCHAR (100) DEFAULT 'JOGJA',
NO_TELPON VARCHAR (13)
)

CREATE TABLE KASIR(
KD_KASIR CHAR (5) PRIMARY KEY NOT NULL,
NAMA_KASIR VARCHAR (50) NOT NULL,
PASS VARCHAR (30) NOT NULL,
LEVEL_KASIR CHAR (2)
)


CREATE TABLE NOTA(
NO_NOTA CHAR(5) PRIMARY KEY NOT NULL,
KD_PELANGGAN CHAR (5) FOREIGN KEY REFERENCES PELANGGAN(KD_PELANGGAN),
KD_KASIR CHAR (5) FOREIGN KEY REFERENCES KASIR(KD_KASIR),
TANGGAL_NOTA DATE NOT NULL
)

CREATE TABLE DETAIL_NOTA(
KD_NOTA CHAR (5) NOT NULL FOREIGN KEY REFERENCES NOTA (NO_NOTA),
KD_BARANG CHAR (5) FOREIGN KEY REFERENCES BARANG (KODE_BARANG),
JUMLAH_BARANG INT NOT NULL,
HARGA_BARANG NUMERIC(18,0) NOT NULL
)

INSERT INTO KASIR VALUES 
('K0001','KARNO','abc123','AK'),
('K0002','MIRNA','jesica123','SK')

INSERT INTO PELANGGAN VALUES
('P0001','APRILIA','BANTUL','0812000111'),
('P0002','ZULKARNAIN','YOGYAKARTA',NULL),
('P0003','ANDIKA','SLEMAN',NULL),
('P0004','PARNO','YOGYAKARTA','0856222999')

INSERT INTO BARANG VALUES
('B0001','RINSO 50 GRAM',3000,100),
('B0002','NESTLE 300 ML',2500,100),
('B0003','TARO 450 GRAM',8500,100),
('B0004','BOLPEN SNOWMAN',1500,100),
('B0005','GULAKU 1 KG',20000,100)

INSERT INTO NOTA VALUES
('N0001','P0001','K0001', '2018-03-03'),
('N0002','P0002','K0002', '2018-03-04'),
('N0003','P0004','K0002', '2018-03-04'),
('N0004','P0004','K0002', '2018-03-05'),
('N0005','P0004','K0001', '2018-03-06'),
('N0006','P0002','K0002', '2018-03-06'),
('N0007','P0003','K0001', '2018-03-07')

DELETE FROM NOTA


INSERT INTO DETAIL_NOTA VALUES
('N0001', 'B0001',3,3500),
('N0001', 'B0002',3,3000),
('N0001', 'B0005',1,21500),
('N0002', 'B0001',2,3500),
('N0003', 'B0003',5,9500),
('N0003', 'B0004',3,2000),
('N0004', 'B0001',6,3500),
('N0004', 'B0004',8,2000),
('N0004', 'B0003',3,9500),
('N0005', 'B0005',2,21500),
('N0006', 'B0001',2,3500),
('N0006', 'B0002',7,3000),
('N0006', 'B0003',3,9500),
('N0007', 'B0002',6,3000)

DELETE FROM DETAIL_NOTA

SELECT * FROM BARANG
SELECT * FROM DETAIL_NOTA
SELECT * FROM NOTA
SELECT * FROM pelanggan
SELECT * FROM kasir

SELECT TOP 3 * FROM NOTA


INSERT INTO KASIR VALUES 
('K0003','MIRNAWATI RAHMASARI','MIRNA5678','SK'),
('K0004','ENDANG SARI SUKARNO','ENDANG123','SK'),
('K0005','EDI RAHMAWAN','EDI99','SK')

INSERT INTO PELANGGAN VALUES 
('P0005','Indah','Yogya',null),
('P0006','Raihan eka', 'Sleman',null),
('P0007','Ekasari','Yogya', '876265')

INSERT INTO BARANG VALUES 
('B0006','Rinso 100 gram',5000,100),
('B0007','Detergen cair Rinso 100 ml',6000,100), 
('B0008','Gulaku stick',1000,100)

INSERT INTO NOTA VALUES
('N0001','P0001','K0001','2018-03-03 10:15:00'),
('N0002','P0002','K0002','2018-03-04 10:10:00'), 
('N0003','P0004','K0002','2018-03-04 10:13:00'),
('N0004','P0001','K0004','2018-03-05 11:15:00'), 
('N0005','P0004','K0001','2018-03-05 15:20:00'), 
('N0006','P0002','K0004','2018-03-05 15:25:00'),
('N0007','P0003','K0002','2018-03-06 12:03:00')

INSERT INTO DETAIL_NOTA VALUES
('N0001','B0001',3,2850), 
('N0001','B0002',2,2500),
('N0001','B0005',1,18500),
('N0002','B0007',1,6000),
('N0003','B0003',2,8450),
('N0003','B0004',10,1500), 
('N0004','B0001',3,2800),
('N0004','B0008',10,1000), 
('N0004','B0003',1,8500),
('N0005','B0003',5,8500),
('N0006','B0007',1,6000),
('N0006','B0002',1,2500),
('N0006','B0005',1,20000), 
('N0007','B0003',4,8500)

UPDATE KASIR SET PASS='jogja0912' WHERE KD_KASIR='K0001'

UPDATE PELANGGAN SET NAMA_PELANGGAN='ANDIKA ZULKARNAIN',ALAMAT='Jl.Nusa indah 101 Concat depok sleman',NO_TELPON='0819243666' 
WHERE KD_PELANGGAN='P0003'

UPDATE BARANG SET HARGA_SATUAN=20000+1500 WHERE KODE_BARANG='B0005'

DELETE FROM PELANGGAN WHERE KD_PELANGGAN='P0007'

UPDATE PELANGGAN SET ALAMAT='YOGYAKARTA' WHERE ALAMAT='YOGYA'

SELECT KD_KASIR,NAMA_KASIR FROM KASIR WHERE NAMA_KASIR LIKE '%MIRNA%'

SELECT KD_PELANGGAN,NAMA_PELANGGAN,NO_TELPON FROM PELANGGAN WHERE NO_TELPON IS NOT NULL

SELECT DISTINCT ALAMAT FROM PELANGGAN

SELECT * FROM BARANG ORDER BY NAMA_BARANG ASC

SELECT KODE_BARANG,NAMA_BARANG,HARGA_SATUAN FROM BARANG WHERE HARGA_SATUAN>3000

SELECT KODE_BARANG,NAMA_BARANG,HARGA_SATUAN FROM BARANG WHERE NAMA_BARANG LIKE '%RINSO%'

SELECT STOK FROM BARANG
SELECT SUM(STOK) FROM BARANG

SELECT NOTA.NO_NOTA,NOTA.TANGGAL_NOTA,PELANGGAN.NAMA_PELANGGAN FROM NOTA LEFT JOIN PELANGGAN ON
NOTA.KD_PELANGGAN=PELANGGAN.KD_PELANGGAN WHERE PELANGGAN.KD_PELANGGAN='P0001' OR PELANGGAN.KD_PELANGGAN='P0004'

SELECT BARANG.KODE_BARANG,BARANG.NAMA_BARANG,DETAIL_NOTA.JUMLAH_BARANG FROM BARANG LEFT JOIN DETAIL_NOTA ON
BARANG.KODE_BARANG=DETAIL_NOTA.KD_BARANG

SELECT PELANGGAN.NAMA_PELANGGAN,NOTA.KD_PELANGGAN, COUNT(NOTA.KD_PELANGGAN) AS TRANSAKSI FROM PELANGGAN LEFT JOIN NOTA 
ON PELANGGAN.KD_PELANGGAN=NOTA.KD_PELANGGAN GROUP BY NOTA.KD_PELANGGAN HAVING COUNT(NOTA.KD_PELANGGAN)>0
